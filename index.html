<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram Feed Viewer</title>
    <style>
        body { font-family: Arial, sans-serif; }
        .post { margin: 10px 0; }
        .post img { max-width: 100%; height: auto; }
        .post p { font-size: 14px; color: #333; }
    </style>
</head>
<body>
    <h1>Fetch Instagram Posts</h1>
    <form id="instagramForm">
        <label for="username">Enter Instagram Username:</label>
        <input type="text" id="username" name="username" required>
        <button type="submit">Fetch Posts</button>
    </form>
    <div id="posts"></div>

    <script>
        document.getElementById("instagramForm").addEventListener("submit", async function (e) {
            e.preventDefault();
            const username = document.getElementById("username").value;

            // Apify Scraper API endpoint
            const apifyUrl = "https://api.apify.com/v2/actor-tasks/YOUR_TASK_ID/runs";
            const apifyToken = "YOUR_APIFY_TOKEN";

            try {
                const response = await fetch(apifyUrl, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "Authorization": `Bearer ${apifyToken}`
                    },
                    body: JSON.stringify({ username: username })
                });

                const runData = await response.json();
                const runId = runData.id;

                // Polling to check when the run completes
                const runStatusUrl = `https://api.apify.com/v2/actor-tasks/YOUR_TASK_ID/runs/${runId}`;
                let runComplete = false;
                let output;

                while (!runComplete) {
                    const statusResponse = await fetch(runStatusUrl, {
                        headers: { "Authorization": `Bearer ${apifyToken}` }
                    });
                    const statusData = await statusResponse.json();

                    if (statusData.status === "SUCCEEDED") {
                        runComplete = true;
                        output = statusData.data;
                    }
                    await new Promise(resolve => setTimeout(resolve, 5000)); // Wait 5 seconds before checking again
                }

                displayPosts(output);
            } catch (error) {
                console.error("Error fetching posts:", error);
            }
        });

        function displayPosts(posts) {
            const postsDiv = document.getElementById("posts");
            postsDiv.innerHTML = "";
            posts.forEach(post => {
                const postElement = `
                    <div class="post">
                        <img src="${post.media_url}" alt="${post.caption}">
                        <p>${post.caption}</p>
                    </div>`;
                postsDiv.innerHTML += postElement;
            });
        }
    </script>
</body>
</html>
